{"version":3,"sources":["scion.js"],"names":["f","exports","module","define","amd","g","window","global","self","scion","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_toConsumableArray","arr","Array","isArray","arr2","from","_classCallCheck","instance","TypeError","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","constructor","value","setPrototypeOf","__proto__","base","helpers","query","transitionComparator","Statechart","_base$BaseInterpreter","modelOrModelFactory","opts","legacySemantics","getPrototypeOf","_selectTransitions","currentEvent","selectEventlessTransitions","transitionSelector","enabledTransitions","Set","_evaluateAction","bind","atomicStates","_configuration","iter","sort","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_iterator","Symbol","iterator","_step","next","done","state","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","loop","_iterator2","concat","getAncestors","_step2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_iterator3","transitions","_step3","add","err","return","priorityEnabledTransitions","_removeConflictingTransition","_log","_this2","filteredTransitions","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_iterator4","_step4","t1","t1Preempted","transitionsToRemove","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_loop","t2","_step5","t1ExitSet","_computeExitSet","t2ExitSet","hasIntersection","some","has","source","id","map","descendants","indexOf","_iterator5","_ret","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_iterator6","_step6","t3","remove","BaseInterpreter","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","setTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","len","run","nextTick","args","arguments","push","Item","array","apply","title","browser","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","inherits","ctor","superCtor","super_","TempCtor","isBuffer","arg","copy","fill","readUInt8","formatRegExp","format","isString","objects","inspect","join","str","String","replace","x","Number","JSON","stringify","_","isNull","isObject","deprecate","fn","msg","isUndefined","noDeprecation","warned","deprecated","throwDeprecation","traceDeprecation","console","trace","error","debugs","debugEnviron","debuglog","set","NODE_DEBUG","toUpperCase","RegExp","test","pid","obj","ctx","seen","stylize","stylizeNoColor","depth","colors","isBoolean","showHidden","_extend","customInspect","stylizeWithColor","formatValue","styles","styleType","style","arrayToHash","hash","forEach","val","idx","recurseTimes","isFunction","ret","primitive","formatPrimitive","keys","visibleKeys","getOwnPropertyNames","isError","formatError","isRegExp","toString","isDate","Date","braces","toUTCString","output","formatArray","formatProperty","pop","reduceToSingleString","simple","isNumber","hasOwnProperty","match","desc","getOwnPropertyDescriptor","get","split","line","substr","numLinesEst","reduce","prev","cur","ar","isNullOrUndefined","isSymbol","re","objectToString","d","isPrimitive","pad","months","timestamp","time","getHours","getMinutes","getSeconds","getDate","getMonth","log","origin","prop","ArraySet","delete","union","v","difference","contains","isEmpty","size","equals","s2","STATE_TYPES","BASIC","COMPOSITE","PARALLEL","HISTORY","INITIAL","FINAL","SCXML_IOPROCESSOR_TYPE","HTTP_IOPROCESSOR_TYPE","RX_TRAILING_WILDCARD","constants","printTrace","extend","transitionWithTargets","initializeModel","isEventPrefixMatch","isTransitionMatch","scxmlPrefixTransitionSelector","eventlessTransitionSelector","getTransitionWithHigherSourceChildPriority","sortInEntryOrder","getStateWithHigherSourceChildPriority","initializeModelGeneratorFn","deserializeSerializedConfiguration","deserializeHistory","to","k","targets","documentOrder","rootState","idToStateMap","Map","idCount","generateId","type","count","wrapInFakeRootState","$deserializeDatamodel","$serializeDatamodel","$idToStateMap","docUrl","states","$type","statesWithInitialAttributes","transitionToString","sourceState","events","cond","stateToString","populateStateIdMap","j","traverse","ancestors","parent","transition","ancs","typeEnum","isAtomic","b","initialChildren","initial","filter","child","initialRef","checkInitialRef","historyChildren","historyRef","every","handler","invokes","invoke","finalize","connectIntialAttributes","initialStates","initialState","RX_WHITESPACE","connectTransitionGraph","onTransition","event","trim","lcca","getLCCA","scope","getScope","transitionIsReallyInternal","s1","commonAncestors","anc","fakeRootState","prefix","fullName","charAt","eventName","tEvent","evaluator","_args","modelFn","interpreter","_x","_sessionid","_ioprocessors","isIn","serializedConfiguration","serializedHistory","sid","isDescendant","root","index","slice","isOrthogonalTo","isAncestrallyRelatedTo","getLCA","getAncestorsOrSelf","getDescendantsOrSelf","EventEmitter","util","DEBUG","InterpreterScriptingContext","_isStepping","_scriptingContext","interpreterScriptingContext","generateSessionid","sessionid","sessionRegistry","location","scxml","model","parse","_model","priorityComparisonFn","_externalEventQueue","_internalEventQueue","params","snapshot","_historyValue","_isInFinalState","EVENTS","parentSession","invokeid","_exitInterpreter","_cancelAllDelayedSends","statesToExit","_getFullConfiguration","stateExited","onExit","exitIdx","exitLen","block","blockIdx","blockLen","actionRef","_handleError","cancelInvoke","send","data","donedata","_initStart","_performBigStep","getConfiguration","cb","genAsync","nop","stateName","getFullConfiguration","keepGoing","allStatesExited","allStatesEntered","_startBigStep","_selectTransitionsAndPerformSmallStep","_finishBigStep","selectedTransitions","ev","shift","statesExited","statesEntered","_performSmallStep","autoforward","action","statesToInvoke","_timeouts","timeoutOptions","sendOptions","delay","timeoutHandle","_timeoutMap","nextStep","setImmediate","selectedTransitionsWithTargets","_exitStates","_executeTransitions","_enterStates","basicStatesExited","_getStatesExited","isDeep","s0","transitionList","txIdx","txLen","configList","cfgIdx","cfgLen","ancIdx","ancLen","sortedStatesExited","sortedTransitions","stxIdx","targetIds","statesForDefaultEntry","defaultHistoryContent","_computeEntrySet","enterIdx","enterLen","stateEntered","onEntry","entryIdx","entryLen","grandparent","isInFinalState","_getEffectiveTargetStates","statesToEnter","_addDescendantStatesToEnter","ancestor","_addAncestorStatesToEnter","targetState","tagname","column","reason","message","listener","getEvents","stateIdx","stateLen","_serializeHistory","evtObjOrName","optionalData","c","_performBigStepAsync","config","sessionIdCounter","_interpreter","_invokeMap","validateUriRegex","invokeSendTargetRegex","scxmlSendTargetRegex","_installDefaultPropsOnEvent","xmlString","xmlParser","invokeObj","Promise","resolve","reject","invokers","session","sessionPromise","then","cancel","isInternal","origintype","options","sendType","validateSend","sendAction","targetIsValidUri","sendid","defaultSendAction","raise","doSend","targetSessionId","invokeId","sendAsync","publish","sendFn","customSend","customCancel","_listeners","_on","_once","__once","_off","splice","_emit","__emit"],"mappings":"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","file":"scion.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.scion = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar base = require('scion-core-base'),\n    helpers = base.helpers,\n    query = base.query,\n    transitionComparator = base.helpers.transitionComparator;\n\n/** \n * @description Implements semantics described in Algorithm D of the SCXML specification. \n * See {@link scion.BaseInterpreter} for information on the constructor arguments.\n * @class SCInterpreter \n * @extends BaseInterpreter\n */\n\nvar Statechart = function (_base$BaseInterpreter) {\n  _inherits(Statechart, _base$BaseInterpreter);\n\n  function Statechart(modelOrModelFactory, opts) {\n    _classCallCheck(this, Statechart);\n\n    opts = opts || {};\n    opts.legacySemantics = false;\n\n    return _possibleConstructorReturn(this, (Statechart.__proto__ || Object.getPrototypeOf(Statechart)).call(this, modelOrModelFactory, opts));\n  }\n\n  /** @private */\n\n\n  _createClass(Statechart, [{\n    key: '_selectTransitions',\n    value: function _selectTransitions(currentEvent, selectEventlessTransitions) {\n      var transitionSelector = this.opts.transitionSelector;\n      var enabledTransitions = new this.opts.Set();\n\n      var e = this._evaluateAction.bind(this, currentEvent);\n\n      var atomicStates = this._configuration.iter().sort(transitionComparator);\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = atomicStates[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var state = _step.value;\n          var _iteratorNormalCompletion2 = true;\n          var _didIteratorError2 = false;\n          var _iteratorError2 = undefined;\n\n          try {\n            loop: for (var _iterator2 = [state].concat(query.getAncestors(state))[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n              var s = _step2.value;\n              var _iteratorNormalCompletion3 = true;\n              var _didIteratorError3 = false;\n              var _iteratorError3 = undefined;\n\n              try {\n                for (var _iterator3 = s.transitions[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                  var t = _step3.value;\n\n                  if (transitionSelector(t, currentEvent, e, selectEventlessTransitions)) {\n                    enabledTransitions.add(t);\n                    break loop;\n                  }\n                }\n              } catch (err) {\n                _didIteratorError3 = true;\n                _iteratorError3 = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                    _iterator3.return();\n                  }\n                } finally {\n                  if (_didIteratorError3) {\n                    throw _iteratorError3;\n                  }\n                }\n              }\n            }\n          } catch (err) {\n            _didIteratorError2 = true;\n            _iteratorError2 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                _iterator2.return();\n              }\n            } finally {\n              if (_didIteratorError2) {\n                throw _iteratorError2;\n              }\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      var priorityEnabledTransitions = this._removeConflictingTransition(enabledTransitions);\n\n      this._log(\"priorityEnabledTransitions\", priorityEnabledTransitions);\n\n      return priorityEnabledTransitions;\n    }\n\n    /** @private */\n\n  }, {\n    key: '_removeConflictingTransition',\n    value: function _removeConflictingTransition(enabledTransitions) {\n      var _this2 = this;\n\n      var filteredTransitions = new this.opts.Set();\n      //toList sorts the transitions in the order of the states that selected them\n      var _iteratorNormalCompletion4 = true;\n      var _didIteratorError4 = false;\n      var _iteratorError4 = undefined;\n\n      try {\n        for (var _iterator4 = enabledTransitions.iter()[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n          var t1 = _step4.value;\n\n          var t1Preempted = false;\n          var transitionsToRemove = new Set();\n          var _iteratorNormalCompletion5 = true;\n          var _didIteratorError5 = false;\n          var _iteratorError5 = undefined;\n\n          try {\n            var _loop = function _loop() {\n              var t2 = _step5.value;\n\n              //TODO: can we compute this statically? for example, by checking if the transition scopes are arena orthogonal?\n              var t1ExitSet = _this2._computeExitSet([t1]);\n              var t2ExitSet = _this2._computeExitSet([t2]);\n              var hasIntersection = [].concat(_toConsumableArray(t1ExitSet)).some(function (s) {\n                return t2ExitSet.has(s);\n              }) || [].concat(_toConsumableArray(t2ExitSet)).some(function (s) {\n                return t1ExitSet.has(s);\n              });\n              _this2._log('t1ExitSet', t1.source.id, [].concat(_toConsumableArray(t1ExitSet)).map(function (s) {\n                return s.id;\n              }));\n              _this2._log('t2ExitSet', t2.source.id, [].concat(_toConsumableArray(t2ExitSet)).map(function (s) {\n                return s.id;\n              }));\n              _this2._log('hasIntersection', hasIntersection);\n              if (hasIntersection) {\n                if (t2.source.descendants.indexOf(t1.source) > -1) {\n                  //is this the same as being ancestrally related?\n                  transitionsToRemove.add(t2);\n                } else {\n                  t1Preempted = true;\n                  return 'break';\n                }\n              }\n            };\n\n            for (var _iterator5 = filteredTransitions.iter()[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n              var _ret = _loop();\n\n              if (_ret === 'break') break;\n            }\n          } catch (err) {\n            _didIteratorError5 = true;\n            _iteratorError5 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion5 && _iterator5.return) {\n                _iterator5.return();\n              }\n            } finally {\n              if (_didIteratorError5) {\n                throw _iteratorError5;\n              }\n            }\n          }\n\n          if (!t1Preempted) {\n            var _iteratorNormalCompletion6 = true;\n            var _didIteratorError6 = false;\n            var _iteratorError6 = undefined;\n\n            try {\n              for (var _iterator6 = transitionsToRemove[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n                var t3 = _step6.value;\n\n                filteredTransitions.remove(t3);\n              }\n            } catch (err) {\n              _didIteratorError6 = true;\n              _iteratorError6 = err;\n            } finally {\n              try {\n                if (!_iteratorNormalCompletion6 && _iterator6.return) {\n                  _iterator6.return();\n                }\n              } finally {\n                if (_didIteratorError6) {\n                  throw _iteratorError6;\n                }\n              }\n            }\n\n            filteredTransitions.add(t1);\n          }\n        }\n      } catch (err) {\n        _didIteratorError4 = true;\n        _iteratorError4 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion4 && _iterator4.return) {\n            _iterator4.return();\n          }\n        } finally {\n          if (_didIteratorError4) {\n            throw _iteratorError4;\n          }\n        }\n      }\n\n      return filteredTransitions;\n    }\n  }]);\n\n  return Statechart;\n}(base.BaseInterpreter);\n\nbase.Statechart = Statechart;\nmodule.exports = base;\n\n},{\"scion-core-base\":10}],2:[function(require,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],3:[function(require,module,exports){\nif (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n\n},{}],4:[function(require,module,exports){\nmodule.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}\n},{}],5:[function(require,module,exports){\n(function (process,global){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\n}).call(this,require('_process'),typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./support/isBuffer\":4,\"_process\":2,\"inherits\":3}],6:[function(require,module,exports){\n/* begin ArraySet */\n\n/** @constructor */\nfunction ArraySet(l) {\n    l = l || [];\n    this.o = new Set(l);        \n}\n\nArraySet.prototype = {\n\n    add : function(x) {\n        this.o.add(x);\n    },\n\n    remove : function(x) {\n        return this.o.delete(x);\n    },\n\n    union : function(l) {\n        for (var v of l.o) {\n            this.o.add(v);\n        }\n        return this;\n    },\n\n    difference : function(l) {\n        for (var v of l.o) {\n            this.o.delete(v);\n        }\n        return this;\n    },\n\n    contains : function(x) {\n        return this.o.has(x);\n    },\n\n    iter : function() {\n        return Array.from(this.o);\n    },\n\n    isEmpty : function() {\n        return !this.o.size;\n    },\n\n    size: function() {\n        return this.o.size;\n    },\n\n    equals : function(s2) {\n        if (this.o.size !== s2.size()) {\n            return false;\n        }\n\n        for (var v of this.o) {\n            if (!s2.contains(v)) {\n                return false;\n            }\n        }\n\n        return true;\n    },\n\n    toString : function() {\n        return this.o.size === 0 ? '<empty>' : Array.from(this.o).join(',\\n');\n    }\n};\n\nmodule.exports = ArraySet;\n\n},{}],7:[function(require,module,exports){\nvar STATE_TYPES = {\n    BASIC: 0,\n    COMPOSITE: 1,\n    PARALLEL: 2,\n    HISTORY: 3,\n    INITIAL: 4,\n    FINAL: 5\n};\n\nconst SCXML_IOPROCESSOR_TYPE = 'http://www.w3.org/TR/scxml/#SCXMLEventProcessor'\nconst HTTP_IOPROCESSOR_TYPE = 'http://www.w3.org/TR/scxml/#BasicHTTPEventProcessor'\nconst RX_TRAILING_WILDCARD = /\\.\\*$/;\n\nmodule.exports = {\n  STATE_TYPES : STATE_TYPES,\n  SCXML_IOPROCESSOR_TYPE  : SCXML_IOPROCESSOR_TYPE,\n  HTTP_IOPROCESSOR_TYPE  : HTTP_IOPROCESSOR_TYPE, \n  RX_TRAILING_WILDCARD  : RX_TRAILING_WILDCARD \n};\n\n},{}],8:[function(require,module,exports){\nconst constants = require('./constants'),\n      STATE_TYPES = constants.STATE_TYPES,\n      RX_TRAILING_WILDCARD = constants.RX_TRAILING_WILDCARD;\n\nconst printTrace = false;\n\nmodule.exports = {\n  extend : extend,\n  transitionWithTargets : transitionWithTargets,\n  transitionComparator : transitionComparator,\n  initializeModel : initializeModel,\n  isEventPrefixMatch : isEventPrefixMatch,\n  isTransitionMatch : isTransitionMatch,\n  scxmlPrefixTransitionSelector : scxmlPrefixTransitionSelector,\n  eventlessTransitionSelector : eventlessTransitionSelector,\n  getTransitionWithHigherSourceChildPriority : getTransitionWithHigherSourceChildPriority,\n  sortInEntryOrder : sortInEntryOrder,\n  getStateWithHigherSourceChildPriority : getStateWithHigherSourceChildPriority,\n  initializeModelGeneratorFn : initializeModelGeneratorFn,\n  deserializeSerializedConfiguration : deserializeSerializedConfiguration,\n  deserializeHistory : deserializeHistory\n};\n\nfunction extend (to, from){\n  Object.keys(from).forEach(function(k){\n    to[k] = from[k]; \n  });\n  return to;\n};\n\nfunction transitionWithTargets(t){\n    return t.targets;\n}\n\nfunction transitionComparator(t1, t2) {\n    return t1.documentOrder - t2.documentOrder;\n}\n\nfunction initializeModel(rootState, opts){\n    var transitions = [], idToStateMap = new Map(), documentOrder = 0;\n\n\n    //TODO: need to add fake ids to anyone that doesn't have them\n    //FIXME: make this safer - break into multiple passes\n    var idCount = {};\n\n    function generateId(type){\n        if(idCount[type] === undefined) idCount[type] = 0;\n\n        do {\n          var count = idCount[type]++;\n          var id = '$generated-' + type + '-' + count; \n        } while (idToStateMap.has(id))\n        \n        return id;\n    }\n\n    function wrapInFakeRootState(state){\n        return {\n            $deserializeDatamodel : state.$deserializeDatamodel || function(){},\n            $serializeDatamodel : state.$serializeDatamodel || function(){ return null;},\n            $idToStateMap : idToStateMap,   //keep this for handy deserialization of serialized configuration\n            docUrl : state.docUrl,\n            name : state.name,\n            states : [\n                {\n                    $type : 'initial',\n                    transitions : [{\n                        target : state\n                    }]\n                },\n                state\n            ]\n        };\n    }\n\n    var statesWithInitialAttributes = [];\n\n    /**\n      @this {SCTransition}\n    */\n    function transitionToString(sourceState){\n      return `${sourceState} -- ${this.events ? '(' + this.events.join(',') + ')' : null}${this.cond ? '[' + this.cond.name + ']' : ''} --> ${this.targets ? this.targets.join(',') : null}`;\n    }\n\n    /**\n      @this {SCState}\n    */\n    function stateToString(){\n      return this.id;\n    }\n\n    function populateStateIdMap(state){\n      //populate state id map\n      if(state.id){\n          idToStateMap.set(state.id, state);\n      }\n\n      if(state.states) {\n          for (var j = 0, len = state.states.length; j < len; j++) {\n              populateStateIdMap(state.states[j]);\n          }\n      }\n    }\n\n    function traverse(ancestors,state){\n\n        if(printTrace) state.toString = stateToString;\n\n        //add to global transition and state id caches\n        if(state.transitions) transitions.push.apply(transitions,state.transitions);\n\n        //create a default type, just to normalize things\n        //this way we can check for unsupported types below\n        state.$type = state.$type || 'state';\n\n        //add ancestors and depth properties\n        state.ancestors = ancestors;\n        state.depth = ancestors.length;\n        state.parent = ancestors[0];\n        state.documentOrder = documentOrder++; \n\n        //add some information to transitions\n        state.transitions = state.transitions || [];\n        for (var j = 0, len = state.transitions.length; j < len; j++) {\n            var transition = state.transitions[j];\n            transition.documentOrder = documentOrder++; \n            transition.source = state;\n            if(printTrace) transition.toString = transitionToString.bind(transition, state);\n        };\n\n        //recursive step\n        if(state.states) {\n            var ancs = [state].concat(ancestors);\n            for (var j = 0, len = state.states.length; j < len; j++) {\n                traverse(ancs, state.states[j]);\n            }\n        }\n\n        //setup fast state type\n        switch(state.$type){\n            case 'parallel':\n                state.typeEnum = STATE_TYPES.PARALLEL;\n                state.isAtomic = false;\n                break;\n            case 'initial' : \n                state.typeEnum = STATE_TYPES.INITIAL;\n                state.isAtomic = true;\n                break;\n            case 'history' :\n                state.typeEnum = STATE_TYPES.HISTORY;\n                state.isAtomic = true;\n                break;\n            case 'final' : \n                state.typeEnum = STATE_TYPES.FINAL;\n                state.isAtomic = true;\n                break;\n            case 'state' : \n            case 'scxml' :\n                if(state.states && state.states.length){\n                    state.typeEnum = STATE_TYPES.COMPOSITE;\n                    state.isAtomic = false;\n                }else{\n                    state.typeEnum = STATE_TYPES.BASIC;\n                    state.isAtomic = true;\n                }\n                break;\n            default :\n                throw new Error('Unknown state type: ' + state.$type);\n        }\n\n        //descendants property on states will now be populated. add descendants to this state\n        if(state.states){\n            state.descendants = state.states.concat(state.states.map(function(s){return s.descendants;}).reduce(function(a,b){return a.concat(b);},[]));\n        }else{\n            state.descendants = [];\n        }\n\n        var initialChildren;\n        if(state.typeEnum === STATE_TYPES.COMPOSITE){\n            //set up initial state\n            \n            if(Array.isArray(state.initial) || typeof state.initial === 'string'){\n                statesWithInitialAttributes.push(state);\n            }else{\n                //take the first child that has initial type, or first child\n                initialChildren = state.states.filter(function(child){\n                    return child.$type === 'initial';\n                });\n\n                state.initialRef = [initialChildren.length ? initialChildren[0] : state.states[0]];\n                checkInitialRef(state);\n            }\n\n        }\n\n        //hook up history\n        if(state.typeEnum === STATE_TYPES.COMPOSITE ||\n                state.typeEnum === STATE_TYPES.PARALLEL){\n\n            var historyChildren = state.states.filter(function(s){\n                return s.$type === 'history';\n            }); \n\n           state.historyRef = historyChildren;\n        }\n\n        //now it's safe to fill in fake state ids\n        if(!state.id){\n            state.id = generateId(state.$type);\n            idToStateMap.set(state.id, state);\n        }\n\n        //normalize onEntry/onExit, which can be single fn or array, or array of arrays (blocks)\n        ['onEntry','onExit'].forEach(function(prop){\n          if (state[prop]) {\n            if(!Array.isArray(state[prop])){\n              state[prop] = [state[prop]];\n            }\n            if(!state[prop].every(function(handler){ return Array.isArray(handler); })){\n              state[prop] = [state[prop]];\n            }\n          }\n        });\n\n        if (state.invokes && !Array.isArray(state.invokes)) {\n            state.invokes = [state.invokes];\n            state.invokes.forEach( invoke => {\n              if (invoke.finalize && !Array.isArray(invoke.finalize)) {\n                invoke.finalize = [invoke.finalize];\n              }\n            })\n        }\n    }\n\n    //TODO: convert events to regular expressions in advance\n\n    function checkInitialRef(state){\n      if(!state.initialRef) throw new Error('Unable to locate initial state for composite state: ' + state.id);\n    }\n    function connectIntialAttributes(){\n      for (var j = 0, len = statesWithInitialAttributes.length; j < len; j++) {\n        var s = statesWithInitialAttributes[j];\n\n        var initialStates = Array.isArray(s.initial) ? s.initial : [s.initial];\n        s.initialRef = initialStates.map(function(initialState){ return idToStateMap.get(initialState); });\n        checkInitialRef(s);\n      }\n    }\n\n    var RX_WHITESPACE = /\\s+/;\n\n    function connectTransitionGraph(){\n        //normalize as with onEntry/onExit\n        for (var i = 0, len = transitions.length; i < len; i++) {\n            var t = transitions[i];\n            if (t.onTransition && !Array.isArray(t.onTransition)) {\n                t.onTransition = [t.onTransition];\n            }\n\n            //normalize \"event\" attribute into \"events\" attribute\n            if (typeof t.event === 'string') {\n                t.events = t.event.trim().split(RX_WHITESPACE);\n            }\n            delete t.event;\n\n            if(t.targets || (typeof t.target === 'undefined')) {\n                //targets have already been set up\n                continue;\n            }   \n\n            if(typeof t.target === 'string'){\n                var target = idToStateMap.get(t.target);\n                if(!target) throw new Error('Unable to find target state with id ' + t.target);\n                t.target = target;\n                t.targets = [t.target];\n            }else if(Array.isArray(t.target)){\n                t.targets = t.target.map(function(target){\n                    if(typeof target === 'string'){\n                        target = idToStateMap.get(target);\n                        if(!target) throw new Error('Unable to find target state with id ' + t.target);\n                        return target;\n                    }else{\n                        return target;\n                    } \n                }); \n            }else if(typeof t.target === 'object'){\n                t.targets = [t.target];\n            }else{\n                throw new Error('Transition target has unknown type: ' + t.target);\n            }\n        }\n\n        //hook up LCA - optimization\n        for (var i = 0, len = transitions.length; i < len; i++) {\n            var t = transitions[i];\n            if(t.targets) t.lcca = getLCCA(t.source,t.targets[0]);    //FIXME: we technically do not need to hang onto the lcca. only the scope is used by the algorithm\n\n            t.scope = getScope(t);\n        }\n    }\n\n    function getScope(transition){\n        //Transition scope is normally the least common compound ancestor (lcca).\n        //Internal transitions have a scope equal to the source state.\n        var transitionIsReallyInternal = \n                transition.type === 'internal' &&\n                  transition.source.typeEnum === STATE_TYPES.COMPOSITE &&   //is transition source a composite state\n                  transition.source.parent &&    //root state won't have parent\n                  transition.targets && //does it target its descendants\n                  transition.targets.every(\n                      function(target){ return transition.source.descendants.indexOf(target) > -1;});\n\n        if(!transition.targets){\n            return null;\n        }else if(transitionIsReallyInternal){\n            return transition.source; \n        }else{\n            return transition.lcca;\n        }\n    }\n\n    function getLCCA(s1, s2) {\n        var commonAncestors = [];\n        for (var j = 0, len = s1.ancestors.length; j < len; j++) {\n            var anc = s1.ancestors[j];\n            if(\n                (\n                  opts && opts.legacySemantics ? \n                    anc.typeEnum === STATE_TYPES.COMPOSITE :\n                    (anc.typeEnum === STATE_TYPES.COMPOSITE || anc.typeEnum === STATE_TYPES.PARALLEL) \n                ) &&\n                anc.descendants.indexOf(s2) > -1){\n\n                commonAncestors.push(anc);\n            }\n        };\n        if(!commonAncestors.length) throw new Error(\"Could not find LCA for states.\");\n        return commonAncestors[0];\n    }\n\n    //main execution starts here\n    //FIXME: only wrap in root state if it's not a compound state\n    populateStateIdMap(rootState);\n    var fakeRootState = wrapInFakeRootState(rootState);  //I wish we had pointer semantics and could make this a C-style \"out argument\". Instead we return him\n    traverse([],fakeRootState);\n    connectTransitionGraph();\n    connectIntialAttributes();\n\n    return fakeRootState;\n}\n\n\nfunction isEventPrefixMatch(prefix, fullName) {\n    prefix = prefix.replace(RX_TRAILING_WILDCARD, '');\n\n    if (prefix === fullName) {\n        return true;\n    }\n\n    if (prefix.length > fullName.length) {\n        return false;\n    }\n\n    if (fullName.charAt(prefix.length) !== '.') {\n        return false;\n    }\n\n    return (fullName.indexOf(prefix) === 0);\n}\n\nfunction isTransitionMatch(t, eventName) {\n    return t.events.some((tEvent) => {\n        return tEvent === '*' || isEventPrefixMatch(tEvent, eventName);\n    });\n}\n\nfunction scxmlPrefixTransitionSelector(t, event, evaluator, selectEventlessTransitions) {\n    return ( \n      selectEventlessTransitions ? \n        !t.events :\n        (t.events && event && event.name && isTransitionMatch(t, event.name))\n      )\n      && (!t.cond || evaluator(t.cond));\n}\n\nfunction eventlessTransitionSelector(state){\n  return state.transitions.filter(function(transition){ return !transition.events || ( transition.events && transition.events.length === 0 ); });\n}\n\n//priority comparison functions\nfunction getTransitionWithHigherSourceChildPriority(_args) {\n    let t1 = _args[0], t2 = _args[1];\n    var r = getStateWithHigherSourceChildPriority(t1.source, t2.source);\n    //compare transitions based first on depth, then based on document order\n    if (t1.source.depth < t2.source.depth) {\n        return t2;\n    } else if (t2.source.depth < t1.source.depth) {\n        return t1;\n    } else {\n       if (t1.documentOrder < t2.documentOrder) {\n            return t1;\n        } else {\n            return t2;\n        }\n    }\n}\n\nfunction sortInEntryOrder(s1, s2){\n  return getStateWithHigherSourceChildPriority(s1, s2) * -1\n}\n\nfunction getStateWithHigherSourceChildPriority(s1, s2) {\n    //compare states based first on depth, then based on document order\n    if (s1.depth > s2.depth) {\n        return -1;\n    } else if (s1.depth < s2.depth) {\n        return 1;\n    } else {\n        //Equality\n        if (s1.documentOrder < s2.documentOrder) {\n            return 1;\n        } else if (s1.documentOrder > s2.documentOrder) {\n            return -1;\n        } else{\n            return 0;\n        }\n    }\n}\n\nfunction initializeModelGeneratorFn(modelFn, opts, interpreter){\n    return modelFn.call(interpreter,\n        opts._x,\n        opts._x._sessionid,\n        opts._x._ioprocessors,\n        interpreter.isIn.bind(interpreter));\n}\n\nfunction deserializeSerializedConfiguration(serializedConfiguration,idToStateMap){\n  return serializedConfiguration.map(function(id){\n    var state = idToStateMap.get(id);\n    if(!state) throw new Error('Error loading serialized configuration. Unable to locate state with id ' + id);\n    return state;\n  });\n}\n\nfunction deserializeHistory(serializedHistory,idToStateMap){\n  var o = {};\n  Object.keys(serializedHistory).forEach(function(sid){\n    o[sid] = serializedHistory[sid].map(function(id){\n      var state = idToStateMap.get(id);\n      if(!state) throw new Error('Error loading serialized history. Unable to locate state with id ' + id);\n      return state;\n    });\n  });\n  return o;\n}\n\n\n},{\"./constants\":7}],9:[function(require,module,exports){\nconst constants = require('./constants');\n\n//model accessor functions\nconst query = {\n    isDescendant : function(s1, s2){\n      //Returns 'true' if state1 is a descendant of state2 (a child, or a child of a child, or a child of a child of a child, etc.) Otherwise returns 'false'.\n      return s2.descendants.indexOf(s1) > -1;\n    },\n    getAncestors: function(s, root) {\n        var ancestors, index, state;\n        index = s.ancestors.indexOf(root);\n        if (index > -1) {\n            return s.ancestors.slice(0, index);\n        } else {\n            return s.ancestors;\n        }\n    },\n    isOrthogonalTo: function(s1, s2) {\n        //Two control states are orthogonal if they are not ancestrally\n        //related, and their smallest, mutual parent is a Concurrent-state.\n        return !this.isAncestrallyRelatedTo(s1, s2) && this.getLCA(s1, s2).typeEnum === constants.STATE_TYPES.PARALLEL;\n    },\n    isAncestrallyRelatedTo: function(s1, s2) {\n        //Two control states are ancestrally related if one is child/grandchild of another.\n        return this.getAncestorsOrSelf(s2).indexOf(s1) > -1 || this.getAncestorsOrSelf(s1).indexOf(s2) > -1;\n    },\n    getAncestorsOrSelf: function(s, root) {\n        return [s].concat(query.getAncestors(s, root));\n    },\n    getDescendantsOrSelf: function(s) {\n        return [s].concat(s.descendants);\n    },\n    getLCA: function(s1, s2) {\n        var commonAncestors = this.getAncestors(s1).filter(function(a){\n            return a.descendants.indexOf(s2) > -1;\n        },this);\n        return commonAncestors[0];\n    }\n};\n\nmodule.exports = query;\n\n},{\"./constants\":7}],10:[function(require,module,exports){\n(function (process){\n//   Copyright 2012-2012 Jacob Beard, INFICON, and other SCION contributors\n//\n//   Licensed under the Apache License, Version 2.0 (the \"License\");\n//   you may not use this file except in compliance with the License.\n//   You may obtain a copy of the License at\n//\n//       http://www.apache.org/licenses/LICENSE-2.0\n//\n//   Unless required by applicable law or agreed to in writing, software\n//   distributed under the License is distributed on an \"AS IS\" BASIS,\n//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n//   See the License for the specific language governing permissions and\n//   limitations under the License.\n\n/**\n * SCION-CORE global object\n * @namespace scion\n */\n\n/**\n * An Array of strings representing the ids all of the basic states the\n * interpreter is in after a big-step completes.\n * @typedef {Array<string>} Configuration\n */\n\n/**\n * A set of basic and composite state ids.\n * @typedef {Array<string>} FullConfiguration\n */\n\n/**\n * A set of basic and composite state ids.\n * @typedef {Array<string>} FullConfiguration\n */\n\n\"use strict\";\n\nconst EventEmitter = require('tiny-events').EventEmitter,\n  util = require('util'),\n  ArraySet = require('./ArraySet'),\n  constants = require('./constants'),\n  helpers = require('./helpers'),\n  query = require('./query'),\n  extend = helpers.extend,\n  transitionWithTargets = helpers.transitionWithTargets,\n  transitionComparator = helpers.transitionComparator,\n  initializeModel = helpers.initializeModel,\n  isEventPrefixMatch = helpers.isEventPrefixMatch,\n  isTransitionMatch = helpers.isTransitionMatch,\n  scxmlPrefixTransitionSelector = helpers.scxmlPrefixTransitionSelector,\n  eventlessTransitionSelector = helpers.eventlessTransitionSelector,\n  getTransitionWithHigherSourceChildPriority = helpers.getTransitionWithHigherSourceChildPriority,\n  sortInEntryOrder = helpers.sortInEntryOrder,\n  getStateWithHigherSourceChildPriority = helpers.getStateWithHigherSourceChildPriority,\n  initializeModelGeneratorFn = helpers.initializeModelGeneratorFn,\n  deserializeSerializedConfiguration = helpers.deserializeSerializedConfiguration,\n  deserializeHistory = helpers.deserializeHistory,\n  BASIC = constants.STATE_TYPES.BASIC,\n  COMPOSITE = constants.STATE_TYPES.COMPOSITE,\n  PARALLEL = constants.STATE_TYPES.PARALLEL,\n  HISTORY = constants.STATE_TYPES.HISTORY,\n  INITIAL = constants.STATE_TYPES.INITIAL,\n  FINAL = constants.STATE_TYPES.FINAL,\n  SCXML_IOPROCESSOR_TYPE  = constants.SCXML_IOPROCESSOR_TYPE;\n\nconst printTrace = typeof process !== 'undefined' && !!process.env.DEBUG;\n\n\n/**\n * @interface EventEmitter\n */\n\n/**\n* @event scion.BaseInterpreter#onError\n* @property {string} tagname The name of the element that produced the error. \n* @property {number} line The line in the source file in which the error occurred.\n* @property {number} column The column in the source file in which the error occurred.\n* @property {string} reason An informative error message. The text is platform-specific and subject to change.\n*/\n\n\n/**\n * @function\n * @name EventEmitter.prototype#on\n * @param {string} type\n * @param {callback} listener\n */\n\n/**\n * @function\n * @name EventEmitter.prototype#once\n * @param {string} type\n * @param {callback} listener\n */\n\n/**\n * @function\n * @name EventEmitter.prototype#off\n * @param {string} type\n * @param {callback} listener\n */\n\n/**\n * @function\n * @name EventEmitter.prototype#emit\n * @param {string} type\n * @param {any} args\n */\n/** \n * @description The SCXML constructor creates an interpreter instance from a model object.\n * @abstract\n * @class BaseInterpreter\n * @memberof scion\n * @extends EventEmitter\n * @param {SCJSON | scxml.ModelFactory} modelOrModelFactory Either an SCJSON root state; or an scxml.ModelFactory, which is a function which returns an SCJSON object. \n * @param opts\n * @param {string} [opts.sessionid] Used to populate SCXML _sessionid.\n * @param {function} [opts.generateSessionid] Factory used to generate sessionid if sessionid keyword is not specified\n * @param {Map<string, BaseInterpreter>} [opts.sessionRegistry] Map used to map sessionid strings to Statechart instances.\n * @param [opts.Set] Class to use as an ArraySet. Defaults to ES6 Set.\n * @param {object} [opts.params]  Used to pass params from invoke. Sets the datamodel when interpreter is instantiated.\n * @param {Snapshot} [opts.snapshot] State machine snapshot. Used to restore a serialized state machine.\n * @param {Statechart} [opts.parentSession]  Used to pass parent session during invoke.\n * @param {string }[opts.invokeid]  Support for id of invoke element at runtime.\n * @param {boolean} [opts.legacySemantics]\n * @param [opts.console]\n * @param [opts.transitionSelector]\n * @param [opts.customCancel]\n * @param [opts.customSend]\n * @param [opts.sendAsync]\n * @param [opts.doSend]\n * @param [opts.invokers]\n * @param [opts.xmlParser]\n * @param [opts.interpreterScriptingContext]\n */\nclass BaseInterpreter extends EventEmitter {\n\n  constructor(modelOrModelFactory, opts){\n\n    super();\n\n    this.opts = opts;\n\n    this.opts.InterpreterScriptingContext = this.opts.InterpreterScriptingContext || InterpreterScriptingContext;\n\n    this._isStepping = false;\n\n    this._scriptingContext = this.opts.interpreterScriptingContext || (this.opts.InterpreterScriptingContext ? new this.opts.InterpreterScriptingContext(this) : {}); \n\n    this.opts.generateSessionid = this.opts.generateSessionid || BaseInterpreter.generateSessionid;\n    this.opts.sessionid = this.opts.sessionid || this.opts.generateSessionid();\n    this.opts.sessionRegistry = this.opts.sessionRegistry || BaseInterpreter.sessionRegistry;  //TODO: define a better interface. For now, assume a Map<sessionid, session>\n\n\n    let _ioprocessors = {};\n    _ioprocessors[SCXML_IOPROCESSOR_TYPE] = {\n      location : `#_scxml_${this.opts.sessionid}`\n    }\n    _ioprocessors.scxml = _ioprocessors[SCXML_IOPROCESSOR_TYPE];    //alias\n\n    //SCXML system variables:\n    this.opts._x = {\n        _sessionid : this.opts.sessionid,\n        _ioprocessors : _ioprocessors\n    };\n\n\n    var model;\n    if(typeof modelOrModelFactory === 'function'){\n        model = initializeModelGeneratorFn(modelOrModelFactory, this.opts, this);\n    }else if(typeof modelOrModelFactory === 'object'){\n        model = JSON.parse(JSON.stringify(modelOrModelFactory)); //assume object\n    }else{\n        throw new Error('Unexpected model type. Expected model factory function, or scjson object.');\n    }\n\n    this._model = initializeModel(model, this.opts);\n\n    this.opts.console = this.opts.console || (typeof console === 'undefined' ? {log : function(){}} : console);   //rely on global console if this console is undefined\n    this.opts.Set = this.opts.Set || ArraySet;\n    this.opts.priorityComparisonFn = this.opts.priorityComparisonFn || getTransitionWithHigherSourceChildPriority;\n    this.opts.transitionSelector = this.opts.transitionSelector || scxmlPrefixTransitionSelector;\n\n    this.opts.sessionRegistry.set(String(this.opts.sessionid), this);\n\n    this._scriptingContext.log = this._scriptingContext.log || (function log(){ \n      if(this.opts.console.log.apply){\n        this.opts.console.log.apply(this.opts.console, arguments); \n      } else {\n        //console.log on older IE does not support Function.apply, so just pass him the first argument. Best we can do for now.\n        this.opts.console.log(Array.prototype.slice.apply(arguments).join(',')); \n      }\n    }.bind(this));   //set up default scripting context log function\n\n    this._externalEventQueue = [];\n    this._internalEventQueue = [];\n\n    if(this.opts.params){\n      this._model.$deserializeDatamodel(this.opts.params);   //load up the datamodel\n    }\n\n    //check if we're loading from a previous snapshot\n    if(this.opts.snapshot){\n      this._configuration = new this.opts.Set(deserializeSerializedConfiguration(this.opts.snapshot[0], this._model.$idToStateMap));\n      this._historyValue = deserializeHistory(this.opts.snapshot[1], this._model.$idToStateMap); \n      this._isInFinalState = this.opts.snapshot[2];\n      this._model.$deserializeDatamodel(this.opts.snapshot[3]);   //load up the datamodel\n      this._internalEventQueue = this.opts.snapshot[4];\n    }else{\n      this._configuration = new this.opts.Set();\n      this._historyValue = {};\n      this._isInFinalState = false;\n    }\n\n    //add debug logging\n    BaseInterpreter.EVENTS.forEach(function(event){\n      this.on(event, this._log.bind(this,event));\n    }, this);\n\n    module.exports.emit('new',this);\n  }\n\n  /** \n  * Cancels the session. This clears all timers; puts the interpreter in a\n  * final state; and runs all exit actions on current states.\n  * @memberof BaseInterpreter.prototype\n  */\n  cancel(){\n    delete this.opts.parentSession;\n    if(this._isInFinalState) return;\n    this._isInFinalState = true;\n    this._log(`session cancelled ${this.opts.invokeid}`);\n    this._exitInterpreter(null);\n  }\n\n  _exitInterpreter(event){\n    //TODO: cancel invoked sessions\n    //cancel all delayed sends when we enter into a final state.\n    this._cancelAllDelayedSends();\n\n    let statesToExit = this._getFullConfiguration().sort(getStateWithHigherSourceChildPriority);\n\n    for (var j = 0, len = statesToExit.length; j < len; j++) {\n        var stateExited = statesToExit[j];\n\n        if(stateExited.onExit !== undefined) {\n            for (var exitIdx = 0, exitLen = stateExited.onExit.length; exitIdx < exitLen; exitIdx++) {\n                let block = stateExited.onExit[exitIdx];\n                for (let blockIdx = 0, blockLen = block.length; blockIdx < blockLen; blockIdx++) {\n                    let actionRef = block[blockIdx];\n                    try {\n                      actionRef.call(this._scriptingContext, null);\n                    } catch (e){\n                      this._handleError(e, actionRef);\n                      break;\n                    }\n                }\n            }\n        }\n\n        //cancel invoked session\n        if(stateExited.invokes) stateExited.invokes.forEach( invoke => {\n          this._scriptingContext.cancelInvoke(invoke.id);\n        })\n\n        //if he is a top-level <final> state, then return the done event\n        if( stateExited.$type === 'final' &&\n            stateExited.parent.$type === 'scxml'){\n\n          if(this.opts.parentSession){\n            this._scriptingContext.send({\n              target: '#_parent', \n              name: 'done.invoke.' + this.opts.invokeid,\n              data : stateExited.donedata && stateExited.donedata.call(this._scriptingContext, event)\n            });\n          }\n\n          this.opts.sessionRegistry.delete(this.opts.sessionid);\n          this.emit('onExitInterpreter', event);\n        }\n    }\n\n  }\n\n  /** \n   * Starts the interpreter. Should only be called once, and should be called\n   * before BaseInterpreter.prototype#gen is called for the first time.  Returns a\n   * Configuration.\n   * @return {Configuration}\n   * @memberof BaseInterpreter.prototype\n   * @emits scion.BaseInterpreter#onEntry\n   * @emits scion.BaseInterpreter#onExit\n   * @emits scion.BaseInterpreter#onTransition\n   * @emits scion.BaseInterpreter#onDefaultEntry\n   * @emits scion.BaseInterpreter#onError\n   * @emits scion.BaseInterpreter#onBigStepBegin\n   * @emits scion.BaseInterpreter#onBigStepEnd\n   * @emits scion.BaseInterpreter#onBigStepSuspend\n   * @emits scion.BaseInterpreter#onBigStepResume\n   * @emits scion.BaseInterpreter#onSmallStepBegin\n   * @emits scion.BaseInterpreter#onSmallStepEnd\n   * @emits scion.BaseInterpreter#onBigStepEnd\n   * @emits scion.BaseInterpreter#onExitInterpreter\n   */\n  start() {\n      this._initStart();\n      this._performBigStep();\n      return this.getConfiguration();\n  }\n\n\n  /**\n   * This callback is displayed as a global member.\n   * @callback genCallback\n   * @param {Error} err\n   * @param {Configuration} configuration\n   */\n\n  /**\n   * Starts the interpreter asynchronously\n   * @param  {genCallback} cb Callback invoked with an error or the interpreter's stable configuration\n   * @memberof BaseInterpreter.prototype \n   * @emits scion.BaseInterpreter#onEntry\n   * @emits scion.BaseInterpreter#onExit\n   * @emits scion.BaseInterpreter#onTransition\n   * @emits scion.BaseInterpreter#onDefaultEntry\n   * @emits scion.BaseInterpreter#onError\n   * @emits scion.BaseInterpreter#onBigStepBegin\n   * @emits scion.BaseInterpreter#onBigStepEnd\n   * @emits scion.BaseInterpreter#onBigStepSuspend\n   * @emits scion.BaseInterpreter#onBigStepResume\n   * @emits scion.BaseInterpreter#onSmallStepBegin\n   * @emits scion.BaseInterpreter#onSmallStepEnd\n   * @emits scion.BaseInterpreter#onBigStepEnd\n   * @emits scion.BaseInterpreter#onExitInterpreter\n   */\n  startAsync(cb) {\n      cb = this._initStart(cb);\n      this.genAsync(null, cb);\n  }\n\n  _initStart(cb){\n      if (typeof cb !== 'function') {\n          cb = nop;\n      }\n\n      this._log(\"performing initial big step\");\n\n      //We effectively need to figure out states to enter here to populate initial config. assuming root is compound state makes this simple.\n      //but if we want it to be parallel, then this becomes more complex. so when initializing the model, we add a 'fake' root state, which\n      //makes the following operation safe.\n      this._model.initialRef.forEach( s => this._configuration.add(s) );\n\n      return cb;\n  }\n\n  /** \n  * Returns state machine {@link Configuration}.\n  * @return {Configuration}\n  * @memberof BaseInterpreter.prototype \n  */\n  getConfiguration() {\n      return this._configuration.iter().map(function(s){return s.id;});\n  }\n\n  _getFullConfiguration(){\n      return this._configuration.iter().\n              map(function(s){ return [s].concat(query.getAncestors(s));},this).\n              reduce(function(a,b){return a.concat(b);},[]).    //flatten\n              reduce(function(a,b){return a.indexOf(b) > -1 ? a : a.concat(b);},[]); //uniq\n  }\n\n\n  /** \n  * @return {FullConfiguration}\n  * @memberof BaseInterpreter.prototype \n  */\n  getFullConfiguration() {\n      return this._getFullConfiguration().map(function(s){return s.id;});\n  }\n\n\n  /** \n  * @return {boolean}\n  * @memberof BaseInterpreter.prototype \n  * @param {string} stateName\n  */\n  isIn(stateName) {\n      return this.getFullConfiguration().indexOf(stateName) > -1;\n  }\n\n  /** \n  * Is the state machine in a final state?\n  * @return {boolean}\n  * @memberof BaseInterpreter.prototype \n  */\n  isFinal() {\n      return this._isInFinalState;\n  }\n\n  /** @private */\n  _performBigStep(e) {\n      let currentEvent, keepGoing, allStatesExited, allStatesEntered;\n      [allStatesExited, allStatesEntered, keepGoing, currentEvent] = this._startBigStep(e);\n\n      while (keepGoing) {\n        [currentEvent, keepGoing] = this._selectTransitionsAndPerformSmallStep(currentEvent, allStatesEntered, allStatesExited);\n      }\n\n      this._finishBigStep(currentEvent, allStatesEntered, allStatesExited);\n  }\n\n  _selectTransitionsAndPerformSmallStep(currentEvent, allStatesEntered, allStatesExited){\n      //first select with null event\n      var selectedTransitions  = this._selectTransitions(currentEvent, true);\n      if(selectedTransitions.isEmpty()){\n        let ev = this._internalEventQueue.shift();\n        if(ev){ \n          currentEvent = ev;\n          selectedTransitions = this._selectTransitions(currentEvent, false);\n        }\n      }\n\n      if(!selectedTransitions.isEmpty()){\n        this.emit('onSmallStepBegin', currentEvent);\n        let statesExited, statesEntered;\n        [statesExited, statesEntered] = this._performSmallStep(currentEvent, selectedTransitions);\n        if(statesExited) statesExited.forEach( s => allStatesExited.add(s) );\n        if(statesEntered) statesEntered.forEach( s => allStatesEntered.add(s) );\n        this.emit('onSmallStepEnd', currentEvent);\n      }\n      let keepGoing = !selectedTransitions.isEmpty() || this._internalEventQueue.length;\n      return [currentEvent, keepGoing];\n  }\n\n  _startBigStep(e){\n      this.emit('onBigStepBegin', e);\n\n      //do applyFinalize and autoforward\n      this._configuration.iter().forEach(state => {\n        if(state.invokes) state.invokes.forEach( invoke =>  {\n          if(invoke.autoforward){\n            //autoforward\n            this._scriptingContext.send({\n              target: `#_${invoke.id}`, \n              name: e.name,\n              data : e.data\n            });\n          }\n          if(invoke.id === e.invokeid){\n            //applyFinalize\n            if(invoke.finalize) invoke.finalize.forEach( action =>  this._evaluateAction(e, action));\n          } \n        })\n      }); \n\n      if (e) this._internalEventQueue.push(e);\n\n      let allStatesExited = new Set(), allStatesEntered = new Set();\n      let keepGoing = true;\n      let currentEvent = e;\n      return [allStatesEntered, allStatesExited, keepGoing, currentEvent];\n  }\n\n  _finishBigStep(e, allStatesEntered, allStatesExited, cb){\n      let statesToInvoke = Array.from(new Set([...allStatesEntered].filter(s => s.invokes && !allStatesExited.has(s)))).sort(sortInEntryOrder);\n\n      // Here we invoke whatever needs to be invoked. The implementation of 'invoke' is platform-specific\n      statesToInvoke.forEach( s => {\n          s.invokes.forEach( f =>  this._evaluateAction(e,f) )\n      });\n\n      // cancel invoke for allStatesExited\n      allStatesExited.forEach( s => {\n        if(s.invokes) s.invokes.forEach( invoke => {\n          this._scriptingContext.cancelInvoke(invoke.id);\n        })\n      });\n\n      // TODO: Invoking may have raised internal error events and we iterate to handle them        \n      //if not internalQueue.isEmpty():\n      //    continue\n\n      this._isInFinalState = this._configuration.iter().every(function(s){ return s.typeEnum === FINAL; });\n      if(this._isInFinalState){\n        this._exitInterpreter(e);\n      }\n      this.emit('onBigStepEnd', e);\n      if(cb) cb(undefined, this.getConfiguration());\n  }\n\n  _cancelAllDelayedSends(){\n    for( let timeoutOptions of this._scriptingContext._timeouts){\n      if(!timeoutOptions.sendOptions.delay) continue;\n      this._log('cancelling delayed send', timeoutOptions);\n      clearTimeout(timeoutOptions.timeoutHandle);\n      this._scriptingContext._timeouts.delete(timeoutOptions);\n    }\n    Object.keys(this._scriptingContext._timeoutMap).forEach(function(key){\n      delete this._scriptingContext._timeoutMap[key];\n    }, this);\n  }\n\n  _performBigStepAsync(e, cb) {\n      let currentEvent, keepGoing, allStatesExited, allStatesEntered;\n      [allStatesExited, allStatesEntered, keepGoing, currentEvent] = this._startBigStep(e);\n\n      function nextStep(emit){\n        this.emit(emit);\n        [currentEvent, keepGoing] = this._selectTransitionsAndPerformSmallStep(currentEvent, allStatesEntered, allStatesExited);\n\n        if(keepGoing){\n          this.emit('onBigStepSuspend');\n          setImmediate(nextStep.bind(this,'onBigStepResume'));\n        }else{\n          this._finishBigStep(currentEvent, allStatesEntered, allStatesExited, cb);\n        }\n      }\n      nextStep.call(this,'onBigStepBegin');\n  }\n\n  /** @private */\n  _performSmallStep(currentEvent, selectedTransitions) {\n\n      this._log(\"selecting transitions with currentEvent\", currentEvent);\n\n      this._log(\"selected transitions\", selectedTransitions);\n\n      let statesExited,\n          statesEntered;\n\n      if (!selectedTransitions.isEmpty()) {\n\n          //we only want to enter and exit states from transitions with targets\n          //filter out targetless transitions here - we will only use these to execute transition actions\n          var selectedTransitionsWithTargets = new this.opts.Set(selectedTransitions.iter().filter(transitionWithTargets));\n\n          statesExited = this._exitStates(currentEvent, selectedTransitionsWithTargets)\n          this._executeTransitions(currentEvent, selectedTransitions);\n          statesEntered = this._enterStates(currentEvent, selectedTransitionsWithTargets)\n\n          this._log(\"new configuration \", this._configuration);\n      }\n\n      return [statesExited, statesEntered];\n  }\n\n  _exitStates(currentEvent, selectedTransitionsWithTargets){\n      let basicStatesExited, statesExited;\n      [basicStatesExited, statesExited] = this._getStatesExited(selectedTransitionsWithTargets); \n\n      this._log('exiting states')\n      for (var j = 0, len = statesExited.length; j < len; j++) {\n          var stateExited = statesExited[j];\n\n          if(stateExited.isAtomic) this._configuration.remove(stateExited);\n\n          this._log(\"exiting \", stateExited.id);\n\n          //invoke listeners\n          this.emit('onExit',stateExited.id)\n\n          if(stateExited.onExit !== undefined) {\n              for (var exitIdx = 0, exitLen = stateExited.onExit.length; exitIdx < exitLen; exitIdx++) {\n                  let block = stateExited.onExit[exitIdx];\n                  for (let blockIdx = 0, blockLen = block.length; blockIdx < blockLen; blockIdx++) {\n                      let actionRef = block[blockIdx];\n                      try {\n                        actionRef.call(this._scriptingContext, currentEvent);\n                      } catch (e){\n                        this._handleError(e, actionRef);\n                        break;\n                      }\n                  }\n              }\n          }\n\n          var f;\n          if (stateExited.historyRef) {\n              for(let historyRef of stateExited.historyRef){\n                  if (historyRef.isDeep) {\n                      f = function(s0) {\n                          return s0.typeEnum === BASIC && stateExited.descendants.indexOf(s0) > -1;\n                      };\n                  } else {\n                      f = function(s0) {\n                          return s0.parent === stateExited;\n                      };\n                  }\n                  //update history\n                  this._historyValue[historyRef.id] = statesExited.filter(f);\n              }\n          }\n      }\n\n      return statesExited;\n  }\n\n  /** @private */\n  _getStatesExited(transitions) {\n    var statesExited = new this.opts.Set();\n    var basicStatesExited = new this.opts.Set();\n\n    //States exited are defined to be active states that are\n    //descendants of the scope of each priority-enabled transition.\n    //Here, we iterate through the transitions, and collect states\n    //that match this condition. \n    var transitionList = transitions.iter();\n    for (var txIdx = 0, txLen = transitionList.length; txIdx < txLen; txIdx++) {\n      var transition = transitionList[txIdx];\n      var scope = transition.scope,\n          desc = scope.descendants;\n\n      //For each state in the configuration\n      //is that state a descendant of the transition scope?\n      //Store ancestors of that state up to but not including the scope.\n      var configList = this._configuration.iter();\n      for (var cfgIdx = 0, cfgLen = configList.length; cfgIdx < cfgLen; cfgIdx++) {\n        var state = configList[cfgIdx];\n        if(desc.indexOf(state) > -1){\n          basicStatesExited.add(state);\n          statesExited.add(state);\n          var ancestors = query.getAncestors(state,scope); \n          for (var ancIdx = 0, ancLen = ancestors.length; ancIdx < ancLen; ancIdx++) { \n            statesExited.add(ancestors[ancIdx]);\n          }\n        }\n      }\n    }\n\n    var sortedStatesExited = statesExited.iter().sort(getStateWithHigherSourceChildPriority);\n    return [basicStatesExited, sortedStatesExited];\n  }\n\n  _executeTransitions(currentEvent, selectedTransitions){\n      var sortedTransitions = selectedTransitions.iter().sort(transitionComparator);\n\n      this._log(\"executing transitition actions\");\n      for (var stxIdx = 0, len = sortedTransitions.length; stxIdx < len; stxIdx++) {\n          var transition = sortedTransitions[stxIdx];\n\n          var targetIds = transition.targets && transition.targets.map(function(target){return target.id;});\n\n          this.emit('onTransition',transition.source.id,targetIds, transition.source.transitions.indexOf(transition));\n\n          if(transition.onTransition !== undefined) {\n              for (var txIdx = 0, txLen = transition.onTransition.length; txIdx < txLen; txIdx++) {\n                  let actionRef = transition.onTransition[txIdx];\n                  try {\n                    actionRef.call(this._scriptingContext, currentEvent);\n                  } catch (e){\n                    this._handleError(e, actionRef);\n                    break;\n                  }\n              }\n          }\n      }\n  }\n\n  _enterStates(currentEvent, selectedTransitionsWithTargets){\n      this._log(\"entering states\");\n\n      let statesEntered = new Set();\n      let statesForDefaultEntry = new Set();\n      // initialize the temporary table for default content in history states\n      let defaultHistoryContent = {};\n      this._computeEntrySet(selectedTransitionsWithTargets, statesEntered, statesForDefaultEntry, defaultHistoryContent); \n      statesEntered = [...statesEntered].sort(sortInEntryOrder); \n\n      this._log(\"statesEntered \", statesEntered);\n\n      for (var enterIdx = 0, enterLen = statesEntered.length; enterIdx < enterLen; enterIdx++) {\n          var stateEntered = statesEntered[enterIdx];\n\n          if(stateEntered.isAtomic) this._configuration.add(stateEntered);\n\n          this._log(\"entering\", stateEntered.id);\n\n          this.emit('onEntry',stateEntered.id);\n\n          if(stateEntered.onEntry !== undefined) {\n              for (var entryIdx = 0, entryLen = stateEntered.onEntry.length; entryIdx < entryLen; entryIdx++) {\n                  let block = stateEntered.onEntry[entryIdx];\n                  for (let blockIdx = 0, blockLen = block.length; blockIdx < blockLen; blockIdx++) {\n                      let actionRef = block[blockIdx];\n                      try {\n                        actionRef.call(this._scriptingContext, currentEvent);\n                      } catch (e){\n                        this._handleError(e, actionRef);\n                        break;\n                      }\n                  }\n              }\n          }\n\n          if(statesForDefaultEntry.has(stateEntered)){\n              for(let initialState of stateEntered.initialRef){\n                  this.emit('onDefaultEntry', initialState.id);\n                  if(initialState.typeEnum === INITIAL){\n                      let transition = initialState.transitions[0]\n                      if(transition.onTransition !== undefined) {\n                          this._log('executing initial transition content for initial state of parent state',stateEntered.id);\n                          for (var txIdx = 0, txLen = transition.onTransition.length; txIdx < txLen; txIdx++) {\n                              let actionRef = transition.onTransition[txIdx];\n                              try {\n                                actionRef.call(this._scriptingContext, currentEvent);\n                              } catch (e){\n                                this._handleError(e, actionRef);\n                                break;\n                              }\n                          }\n                      }\n                  }\n              }\n          }\n\n\n          if(defaultHistoryContent[stateEntered.id]){\n              let transition = defaultHistoryContent[stateEntered.id]\n              if(transition.onTransition !== undefined) {\n                  this._log('executing history transition content for history state of parent state',stateEntered.id);\n                  for (var txIdx = 0, txLen = transition.onTransition.length; txIdx < txLen; txIdx++) {\n                      let actionRef = transition.onTransition[txIdx];\n                      try {\n                        actionRef.call(this._scriptingContext, currentEvent);\n                      } catch (e){\n                        this._handleError(e, actionRef);\n                        break;\n                      }\n                  }\n              }\n          }\n      }\n\n      for (var enterIdx = 0, enterLen = statesEntered.length; enterIdx < enterLen; enterIdx++) {\n          var stateEntered = statesEntered[enterIdx];\n          if(stateEntered.typeEnum === FINAL){\n            let parent = stateEntered.parent;\n            let grandparent = parent.parent;\n            this._internalEventQueue.push({name : \"done.state.\" + parent.id, data : stateEntered.donedata && stateEntered.donedata.call(this._scriptingContext, currentEvent)});\n            if(grandparent && grandparent.typeEnum === PARALLEL){\n                if(grandparent.states.every(s => this.isInFinalState(s) )){\n                    this._internalEventQueue.push({name : \"done.state.\" + grandparent.id});\n                }\n            }\n          }\n      }\n\n      return statesEntered;\n  }\n\n  _getEffectiveTargetStates(transition){\n    let targets = new Set();\n    for(let s of transition.targets){\n      if(s.typeEnum === HISTORY){\n        if(s.id in this._historyValue)\n          this._historyValue[s.id].forEach( state => targets.add(state))\n        else\n          [...this._getEffectiveTargetStates(s.transitions[0])].forEach( state => targets.add(state))\n      } else {\n        targets.add(s)\n      }\n    }\n    return targets\n  }\n\n  _computeEntrySet(transitions, statesToEnter, statesForDefaultEntry, defaultHistoryContent){\n    for(let t of transitions.iter()){\n      for(let s of t.targets){\n        this._addDescendantStatesToEnter(s,statesToEnter, statesForDefaultEntry, defaultHistoryContent) \n      }\n      let ancestor = t.scope;\n      for(let s of this._getEffectiveTargetStates(t)){\n        this._addAncestorStatesToEnter(s, ancestor, statesToEnter, statesForDefaultEntry, defaultHistoryContent)\n      }\n    }\n  }\n\n  _computeExitSet(transitions) {\n    let statesToExit = new Set();\n    for(let t of transitions){\n      if(t.targets){\n        let scope = t.scope;\n        for(let s of this._getFullConfiguration()){\n          if(query.isDescendant(s,scope)) statesToExit.add(s);\n        }\n      }\n    }\n    return statesToExit; \n  }\n\n  _addAncestorStatesToEnter(state, ancestor, statesToEnter, statesForDefaultEntry, defaultHistoryContent){\n    let traverse = (anc) => {\n      if(anc.typeEnum === PARALLEL){\n        for(let child of anc.states){\n          if(child.typeEnum !== HISTORY && ![...statesToEnter].some(s => query.isDescendant(s, child))){\n            this._addDescendantStatesToEnter(child,statesToEnter, statesForDefaultEntry, defaultHistoryContent) \n          }\n        }\n      }\n    };\n    for(let anc of query.getAncestors(state,ancestor)){\n      statesToEnter.add(anc)\n      traverse(anc)\n    }\n    traverse(ancestor)\n  }\n\n\n  _addDescendantStatesToEnter(state,statesToEnter, statesForDefaultEntry, defaultHistoryContent){\n    if(state.typeEnum === HISTORY){\n      if(this._historyValue[state.id]){\n        for(let s of this._historyValue[state.id])\n          this._addDescendantStatesToEnter(s,statesToEnter, statesForDefaultEntry, defaultHistoryContent)\n\n        for(let s of this._historyValue[state.id])\n          this._addAncestorStatesToEnter(s, state.parent, statesToEnter, statesForDefaultEntry, defaultHistoryContent)\n      } else {\n        defaultHistoryContent[state.parent.id] = state.transitions[0]\n        for(let s of state.transitions[0].targets)\n          this._addDescendantStatesToEnter(s,statesToEnter,statesForDefaultEntry, defaultHistoryContent)\n\n        for(let s of state.transitions[0].targets)\n          this._addAncestorStatesToEnter(s, state.parent, statesToEnter, statesForDefaultEntry, defaultHistoryContent)\n\n      }\n    } else {\n      statesToEnter.add(state)\n        if(state.typeEnum === COMPOSITE){\n          statesForDefaultEntry.add(state)\n          //for each state in initialRef, if it is an initial state, then add ancestors and descendants.\n          for(let s of state.initialRef){\n            let targets = s.typeEnum === INITIAL ? s.transitions[0].targets : [s]; \n            for(let targetState of targets){\n              this._addDescendantStatesToEnter(targetState,statesToEnter, statesForDefaultEntry, defaultHistoryContent)\n            }\n          }\n          for(let s of state.initialRef){\n            let targets = s.typeEnum === INITIAL ? s.transitions[0].targets : [s]; \n            for(let targetState of targets){\n              this._addAncestorStatesToEnter(targetState, state, statesToEnter, statesForDefaultEntry, defaultHistoryContent)\n            }\n          }\n        }else{\n          if(state.typeEnum === PARALLEL){\n            for(let child of state.states){\n              if(child.typeEnum !== HISTORY && ![...statesToEnter].some(s => query.isDescendant(s, child))){\n                this._addDescendantStatesToEnter(child,statesToEnter, statesForDefaultEntry, defaultHistoryContent) \n              }\n            }\n          }\n        }\n    }\n  }\n\n  isInFinalState(s){\n      if(s.typeEnum === COMPOSITE){\n          return s.states.some(s => s.typeEnum === FINAL && this._configuration.contains(s));\n      }else if(s.typeEnum === PARALLEL){\n          return s.states.every(this.isInFinalState.bind(this))\n      }else{\n          return false\n      }\n  }\n\n  /** @private */\n  _evaluateAction(currentEvent, actionRef) {\n      try {\n        return actionRef.call(this._scriptingContext, currentEvent);     //SCXML system variables\n      } catch (e){\n        this._handleError(e, actionRef);\n      }\n  }\n\n  _handleError(e, actionRef){\n    let event = \n      e instanceof Error || (typeof e.__proto__.name === 'string' && e.__proto__.name.match(/^.*Error$/)) ?  //we can't just do 'e instanceof Error', because the Error object in the sandbox is from a different context, and instanceof will return false\n        {\n          name:'error.execution',\n          data : {\n            tagname: actionRef.tagname, \n            line: actionRef.line, \n            column: actionRef.column,\n            reason: e.message\n          },\n          type : 'platform'\n        } : \n        (e.name ? \n          e : \n          {\n            name:'error.execution',\n            data:e,\n            type : 'platform'\n          }\n        );\n    this._internalEventQueue.push(event);\n    this.emit('onError', event);\n  }\n\n  _log(){\n    if(printTrace){\n      var args = Array.from(arguments);\n      this.opts.console.log( \n        `${args[0]}: ${\n          args.slice(1).map(function(arg){\n            return arg === null ? 'null' : \n              ( arg === undefined ? 'undefined' : \n                ( typeof arg === 'string' ? arg : \n                  ( arg.toString() === '[object Object]' ? util.inspect(arg) : arg.toString())));\n\n          }).join(', ')\n        }\\n`\n      );\n    }\n  }\n\n  /**\n  * @interface Listener\n  */\n\n  /**\n  * @function\n  * @name Listener#onEntry \n  * @param {string} stateId\n  */\n\n  /**\n  * @function\n  * @name Listener#onExit \n  * @param {string} stateId\n  */\n\n  /**\n  * @function\n  * @name Listener#onTransition \n  * @param {string} sourceStateId Id of the source state\n  * @param {Array<string>} targetStatesIds Ids of the target states\n  * @param {number} transitionIndex Index of the transition relative to other transitions originating from source state.\n  */\n\n  /**\n  * @function\n  * @name Listener#onError\n  * @param {Error} errorInfo\n  */\n\n  /**\n  * @function\n  * @name Listener#onBigStepBegin\n  */\n\n  /**\n  * @function\n  * @name Listener#onBigStepResume\n  */\n\n  /**\n  * @function\n  * @name Listener#onBigStepSuspend\n  */\n\n  /**\n  * @function\n  * @name Listener#onBigStepEnd\n  */\n\n  /**\n  * @function\n  * @name Listener#onSmallStepBegin\n  * @param {string} event\n  */\n\n  /**\n  * @function\n  * @name Listener#onSmallStepEnd\n  */\n\n\n  /** \n  * Provides a generic mechanism to subscribe to state change and runtime\n  * error notifications.  Can be used for logging and debugging. For example,\n  * can attach a logger that simply logs the state changes.  Or can attach a\n  * network debugging client that sends state change notifications to a\n  * debugging server.\n  * This is an alternative interface to {@link EventEmitter.prototype#on}.\n  * @memberof BaseInterpreter.prototype \n  * @param {Listener} listener\n  */\n  registerListener(listener){\n      BaseInterpreter.EVENTS.forEach(function(event){\n        if(listener[event]) this.on(event,listener[event]);\n      }, this);\n  }\n\n  /** \n  * Unregister a Listener\n  * @memberof BaseInterpreter.prototype \n  * @param {Listener} listener\n  */\n  unregisterListener(listener){\n      BaseInterpreter.EVENTS.forEach(function(event){\n        if(listener[event]) this.off(event,listener[event]);\n      }, this);\n  }\n\n  /** \n  * Query the model to get all transition events.\n  * @return {Array<string>} Transition events.\n  * @memberof BaseInterpreter.prototype \n  */\n  getAllTransitionEvents(){\n      var events = {};\n      function getEvents(state){\n\n          if(state.transitions){\n              for (var txIdx = 0, txLen = state.transitions.length; txIdx < txLen; txIdx++) {\n                  events[state.transitions[txIdx].event] = true;\n              }\n          }\n\n          if(state.states) {\n              for (var stateIdx = 0, stateLen = state.states.length; stateIdx < stateLen; stateIdx++) {\n                  getEvents(state.states[stateIdx]);\n              }\n          }\n      }\n\n      getEvents(this._model);\n\n      return Object.keys(events);\n  }\n\n  /**\n  * Three things capture the current snapshot of a running SCION interpreter:\n  *\n  *      <ul>\n  *      <li> basic configuration (the set of basic states the state machine is in)</li>\n  *      <li> history state values (the states the state machine was in last time it was in the parent of a history state)</li>\n  *      <li> the datamodel</li>\n  *      </ul>\n  *      \n  * The snapshot object can be serialized as JSON and saved to a database. It can\n  * later be passed to the SCXML constructor to restore the state machine\n  * using the snapshot argument.\n  *\n  * @return {Snapshot} \n  * @memberof BaseInterpreter.prototype \n  */\n  getSnapshot(){\n    return [\n      this.getConfiguration(),\n      this._serializeHistory(),\n      this._isInFinalState,\n      this._model.$serializeDatamodel(),\n      this._internalEventQueue.slice()\n    ];\n  }\n\n  _serializeHistory(){\n    var o = {};\n    Object.keys(this._historyValue).forEach(function(sid){\n      o[sid] = this._historyValue[sid].map(function(state){return state.id});\n    },this);\n    return o;\n  }\n\n\n  /**\n   * @interface Event\n   */\n\n  /** \n  * @member name\n  * @memberof Event.prototype \n  * @type string\n  * @description The name of the event\n  */\n\n  /** \n  * @member data\n  * @memberof Event.prototype \n  * @type any\n  * @description The event data\n  */\n\n  /** \n  * An SCXML interpreter takes SCXML events as input, where an SCXML event is an\n  * object with \"name\" and \"data\" properties. These can be passed to method `gen`\n  * as two positional arguments, or as a single object.\n  * @param {string|Event} evtObjOrName\n  * @param {any=} optionalData\n  * @emits scion.BaseInterpreter#onEntry\n  * @emits scion.BaseInterpreter#onExit\n  * @emits scion.BaseInterpreter#onTransition\n  * @emits scion.BaseInterpreter#onDefaultEntry\n  * @emits scion.BaseInterpreter#onError\n  * @emits scion.BaseInterpreter#onBigStepBegin\n  * @emits scion.BaseInterpreter#onBigStepEnd\n  * @emits scion.BaseInterpreter#onBigStepSuspend\n  * @emits scion.BaseInterpreter#onBigStepResume\n  * @emits scion.BaseInterpreter#onSmallStepBegin\n  * @emits scion.BaseInterpreter#onSmallStepEnd\n  * @emits scion.BaseInterpreter#onBigStepEnd\n  * @emits scion.BaseInterpreter#onExitInterpreter\n  */\n  gen(evtObjOrName,optionalData) {\n    var currentEvent;\n    switch(typeof evtObjOrName){\n      case 'string':\n        currentEvent = {name : evtObjOrName, data : optionalData};\n        break;\n      case 'object':\n        if(typeof evtObjOrName.name === 'string'){\n          currentEvent = evtObjOrName;\n        }else{\n          throw new Error('Event object must have \"name\" property of type string.');\n        }\n        break;\n      default:\n        throw new Error('First argument to gen must be a string or object.');\n    }\n\n    if(this._isStepping) throw new Error('Cannot call gen during a big-step');\n\n    //otherwise, kick him off\n    this._isStepping = true;\n\n    this._performBigStep(currentEvent);\n\n    this._isStepping = false;\n    return this.getConfiguration();\n  }\n\n  /**\n  * Injects an external event into the interpreter asynchronously\n  * @param {Event}  currentEvent The event to inject\n  * @param {genCallback} cb Callback invoked with an error or the interpreter's stable configuration\n  * @emits scion.BaseInterpreter#onEntry\n  * @emits scion.BaseInterpreter#onExit\n  * @emits scion.BaseInterpreter#onTransition\n  * @emits scion.BaseInterpreter#onDefaultEntry\n  * @emits scion.BaseInterpreter#onError\n  * @emits scion.BaseInterpreter#onBigStepBegin\n  * @emits scion.BaseInterpreter#onBigStepEnd\n  * @emits scion.BaseInterpreter#onBigStepSuspend\n  * @emits scion.BaseInterpreter#onBigStepResume\n  * @emits scion.BaseInterpreter#onSmallStepBegin\n  * @emits scion.BaseInterpreter#onSmallStepEnd\n  * @emits scion.BaseInterpreter#onBigStepEnd\n  * @emits scion.BaseInterpreter#onExitInterpreter\n  */\n  genAsync(currentEvent, cb) {\n    if (currentEvent !== null && (typeof currentEvent !== 'object' || !currentEvent || typeof currentEvent.name !== 'string')) {\n      throw new Error('Expected currentEvent to be null or an Object with a name');\n    }\n    \n    if (typeof cb !== 'function') {\n      cb = nop;\n    }\n\n    this._externalEventQueue.push([currentEvent, cb]);\n\n    //the semantics we want are to return to the cb the results of processing that particular event.\n    function nextStep(e, c){\n      this._performBigStepAsync(e, function(err, config) {\n        c(err, config);\n\n        if(this._externalEventQueue.length){\n          nextStep.apply(this,this._externalEventQueue.shift());\n        }else{\n          this._isStepping = false;\n        }\n      }.bind(this));\n    }\n    if(!this._isStepping){ \n      this._isStepping = true;\n      nextStep.apply(this,this._externalEventQueue.shift());\n    }\n  }\n}\n\nBaseInterpreter.EVENTS = [\n  'onEntry',\n  'onExit',\n  'onTransition',\n  'onDefaultEntry',\n  'onError',\n  'onBigStepBegin',\n  'onBigStepEnd',\n  'onBigStepSuspend',\n  'onBigStepResume',\n  'onSmallStepBegin',\n  'onSmallStepEnd',\n  'onBigStepEnd',\n  'onExitInterpreter'\n];\n\n//some global singletons to use to generate in-memory session ids, in case the user does not specify these data structures\nBaseInterpreter.sessionIdCounter = 1;\nBaseInterpreter.generateSessionid = function(){\n  return BaseInterpreter.sessionIdCounter++;\n}\nBaseInterpreter.sessionRegistry = new Map();\n\n// Do nothing\n\nfunction nop() {}\n\n\nclass InterpreterScriptingContext{\n  constructor(interpreter){ \n    this._interpreter = interpreter;\n    this._timeoutMap = {};\n    this._invokeMap = {};\n    this._timeouts = new Set()\n\n    //Regex from:\n    //  http://daringfireball.net/2010/07/improved_regex_for_matching_urls\n    //  http://stackoverflow.com/a/6927878\n    this.validateUriRegex = /(#_.*)|\\b((?:[a-z][\\w-]+:(?:\\/{1,3}|[a-z0-9%])|www\\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\\/)(?:[^\\s()<>]+|\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\))+(?:\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\)|[^\\s`!()\\[\\]{};:'\".,<>?«»“”‘’]))/i;\n\n    this.invokeSendTargetRegex = /^#_(.*)$/;\n    this.scxmlSendTargetRegex = /^#_scxml_(.*)$/;\n  }\n\n\n  raise(event){\n    this._installDefaultPropsOnEvent(event, true);\n    this._interpreter._internalEventQueue.push(event); \n  }\n\n  parseXmlStringAsDOM(xmlString){\n    return (this._interpreter.opts.xmlParser || InterpreterScriptingContext.xmlParser).parse(xmlString);\n  }\n\n  invoke(invokeObj){\n    //look up invoker by type. assume invokers are passed in as an option to constructor\n    this._invokeMap[invokeObj.id] = new Promise((resolve, reject) => {\n      (this._interpreter.opts.invokers || InterpreterScriptingContext.invokers)[invokeObj.type](this._interpreter, invokeObj, (err, session) => {\n        if(err) return reject(err);\n\n        this._interpreter.emit('onInvokedSessionInitialized', session);\n        resolve(session);\n      });\n    });\n  }\n\n  cancelInvoke(invokeid){\n    //TODO: on cancel invoke clean up this._invokeMap\n    let sessionPromise = this._invokeMap[invokeid];\n    this._interpreter._log(`cancelling session with invokeid ${invokeid}`);\n    if(sessionPromise){\n      this._interpreter._log(`sessionPromise found`);\n      sessionPromise.then( \n        ((session) => {\n          this._interpreter._log(`resolved session ${invokeid}. cancelling... `);\n          session.cancel(); \n          //clean up\n          delete this._invokeMap[invokeid];\n        }), \n        ( (err) => {\n          //TODO: dispatch error back into the state machine as error.communication\n        }));\n    }\n  }\n\n  _installDefaultPropsOnEvent(event,isInternal){\n    if(!isInternal){ \n      event.origin = this._interpreter.opts._x._ioprocessors.scxml.location;     //TODO: preserve original origin when we autoforward? \n      event.origintype = event.type || SCXML_IOPROCESSOR_TYPE;\n    }\n    if(typeof event.type === 'undefined'){\n      event.type = isInternal ? 'internal' : 'external';\n    }\n    [\n      'name',\n      'sendid',\n      'invokeid',\n      'data',\n      'origin',\n      'origintype'\n    ].forEach(prop => {\n      if(typeof event[prop] === 'undefined'){\n        event[prop] = undefined;\n      }\n    });\n  }\n\n  send(event, options){\n    this._interpreter._log('send event', event, options);\n    options = options || {};\n    var sendType = options.type || SCXML_IOPROCESSOR_TYPE;\n    //TODO: move these out\n    function validateSend(event, options, sendAction){\n      if(event.target){\n        var targetIsValidUri = this.validateUriRegex.test(event.target)\n        if(!targetIsValidUri){\n          throw { name : \"error.execution\", data: 'Target is not valid URI', sendid: event.sendid, type : 'platform' };\n        }\n      }\n      if( sendType !== SCXML_IOPROCESSOR_TYPE) {  //TODO: extend this to support HTTP, and other IO processors\n        throw { name : \"error.execution\", data: 'Unsupported event processor type', sendid: event.sendid, type : 'platform' };\n      }\n\n      sendAction.call(this, event, options);\n    }\n\n    function defaultSendAction (event, options) {\n\n      if( typeof setTimeout === 'undefined' ) throw new Error('Default implementation of BaseInterpreter.prototype.send will not work unless setTimeout is defined globally.');\n\n      var match;\n      if(event.target === '#_internal'){\n        this.raise(event);\n      }else{ \n        this._installDefaultPropsOnEvent(event, false);\n        event.origintype = SCXML_IOPROCESSOR_TYPE;      //TODO: extend this to support HTTP, and other IO processors\n                                                        //TODO : paramterize this based on send/@type?\n        if(!event.target){\n          doSend.call(this, this._interpreter);\n        }else if(event.target === '#_parent'){\n          if(this._interpreter.opts.parentSession){\n            event.invokeid = this._interpreter.opts.invokeid;\n            doSend.call(this, this._interpreter.opts.parentSession);\n          }else{\n            throw { name : \"error.communication\", data: 'Parent session not specified', sendid: event.sendid, type : 'platform' };\n          }\n        } else if(match = event.target.match(this.scxmlSendTargetRegex)){\n          let targetSessionId = match[1];\n          let session = this._interpreter.opts.sessionRegistry.get(targetSessionId)\n          if(session){\n            doSend.call(this,session);\n          }else {\n            throw {name : 'error.communication', sendid: event.sendid, type : 'platform'};\n          }\n        }else if(match = event.target.match(this.invokeSendTargetRegex)){\n          //TODO: test this code path.\n          var invokeId = match[1]\n          this._invokeMap[invokeId].then( (session) => {\n            doSend.call(this,session);\n          })\n        } else {\n          throw new Error('Unrecognized send target.'); //TODO: dispatch error back into the state machine\n        }\n      }\n\n      function doSend(session){\n        //TODO: we probably now need to refactor data structures:\n        //    this._timeouts\n        //    this._timeoutMap\n        var timeoutHandle = setTimeout(function(){\n          if (event.sendid) delete this._timeoutMap[event.sendid];\n          this._timeouts.delete(timeoutOptions);\n          if(this._interpreter.opts.doSend){\n            this._interpreter.opts.doSend(session, event);\n          }else{\n            session[this._interpreter.opts.sendAsync ? 'genAsync' : 'gen'](event);\n          }\n        }.bind(this), options.delay || 0);\n\n        var timeoutOptions = {\n          sendOptions : options,\n          timeoutHandle : timeoutHandle\n        };\n        if (event.sendid) this._timeoutMap[event.sendid] = timeoutHandle;\n        this._timeouts.add(timeoutOptions); \n      }\n    }\n\n    function publish(){\n      this._interpreter.emit(event.name,event.data);\n    }\n\n    //choose send function\n    //TODO: rethink how this custom send works\n    var sendFn;         \n    if(event.type === 'https://github.com/jbeard4/SCION#publish'){\n      sendFn = publish;\n    }else if(this._interpreter.opts.customSend){\n      sendFn = this._interpreter.opts.customSend;\n    }else{\n      sendFn = defaultSendAction;\n    }\n\n    options=options || {};\n\n    this._interpreter._log(\"sending event\", event.name, \"with content\", event.data, \"after delay\", options.delay);\n\n    validateSend.call(this, event, options, sendFn);\n  }\n\n  cancel(sendid){\n    if(this._interpreter.opts.customCancel) {\n      return this._interpreter.opts.customCancel.apply(this, [sendid]);\n    }\n\n    if( typeof clearTimeout === 'undefined' ) throw new Error('Default implementation of BaseInterpreter.prototype.cancel will not work unless setTimeout is defined globally.');\n\n    if (sendid in this._timeoutMap) {\n      this._interpreter._log(\"cancelling \", sendid, \" with timeout id \", this._timeoutMap[sendid]);\n      clearTimeout(this._timeoutMap[sendid]);\n    }\n  }\n}\n\nmodule.exports = extend(new EventEmitter, {\n    BaseInterpreter: BaseInterpreter,\n    ArraySet : ArraySet,\n    STATE_TYPES : constants.STATE_TYPES,\n    initializeModel : initializeModel,\n    InterpreterScriptingContext : InterpreterScriptingContext,\n    helpers: helpers,\n    query: query\n});\n\n}).call(this,require('_process'))\n},{\"./ArraySet\":6,\"./constants\":7,\"./helpers\":8,\"./query\":9,\"_process\":2,\"tiny-events\":11,\"util\":5}],11:[function(require,module,exports){\nfunction EventEmitter() {\n    this._listeners = {};\n}\n\nEventEmitter.prototype.on = function _on(type, listener) {\n    if (!Array.isArray(this._listeners[type])) {\n        this._listeners[type] = [];\n    }\n\n    if (this._listeners[type].indexOf(listener) === -1) {\n        this._listeners[type].push(listener);\n    }\n\n    return this;\n};\n\nEventEmitter.prototype.once = function _once(type, listener) {\n    var self = this;\n\n    function __once() {\n        for (var args = [], i = 0; i < arguments.length; i += 1) {\n            args[i] = arguments[i];\n        }\n\n        self.off(type, __once);\n        listener.apply(self, args);\n    }\n\n    __once.listener = listener;\n\n    return this.on(type, __once);\n};\n\nEventEmitter.prototype.off = function _off(type, listener) {\n    if (!Array.isArray(this._listeners[type])) {\n        return this;\n    }\n\n    if (typeof listener === 'undefined') {\n        this._listeners[type] = [];\n        return this;\n    }\n\n    var index = this._listeners[type].indexOf(listener);\n\n    if (index === -1) {\n        for (var i = 0; i < this._listeners[type].length; i += 1) {\n            if (this._listeners[type][i].listener === listener) {\n                index = i;\n                break;\n            }\n        }\n    }\n\n    this._listeners[type].splice(index, 1);\n    return this;\n};\n\nEventEmitter.prototype.emit = function _emit(type) {\n    if (!Array.isArray(this._listeners[type])) {\n        return this;\n    }\n\n    for (var args = [], i = 1; i < arguments.length; i += 1) {\n        args[i - 1] = arguments[i];\n    }\n\n    this._listeners[type].forEach(function __emit(listener) {\n        listener.apply(this, args);\n    }, this);\n\n    return this;\n};\n\nmodule.exports.EventEmitter = EventEmitter;\n\n},{}]},{},[1])(1)\n});"]}